{"version":3,"sources":["mc_modules/items.js"],"names":[],"mappings":"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","file":"items.js","sourcesContent":["import * as Mc from '@minecraft/server';\nimport { ITEM_STATE_COMPONENTS } from './constants';\n\nexport function compare(itemA,itemB) {\n    if (\n        itemA?.typeId !== itemB?.typeId || \n        itemA?.data !== itemB?.data ||\n        itemA?.nameTag !== itemB?.nameTag\n    ) return false;\n    return true;\n}\n\n//## Comparing state data:\n/**\n * Function to compare if 2 item states are matching.\n * @param {ItemState} itemStateA First item state data to compare.\n * @param {ItemState} itemStateB Second item state data to compare.\n * @returns {boolean} Result of the comparison.\n */\nexport function compareStates(itemStateA, itemStateB) {\n    //### Checking lore\n    const maxLoreLength = Math.max(itemStateA?.lore?.length,itemStateB?.lore?.length);\n    for (let loreIndex = 0;loreIndex < maxLoreLength;++loreIndex) {\n        if (itemStateA.lore[loreIndex] !== itemStateB.lore[loreIndex]) return false;\n    }\n    //### Rest of the item\n    return (\n        itemStateA.typeId === itemStateB.typeId &&\n        itemStateA.nameTag === itemStateB.nameTag &&\n        itemStateA.amount === itemStateB.amount &&\n        itemStateA.keepOnDeath === itemStateB.keepOnDeath &&\n        itemStateA.lockMode === itemStateB.lockMode &&\n        compareComponents(itemStateA.components,itemStateB.components)\n    );\n}\n/**\n * Function to compare if 2 item component states are matching.\n * @param {ItemComponentState} componentsA First item component data to compare.\n * @param {ItemComponentState} componentsB Second item component data to compare.\n * @returns {boolean | undefined} Returns the result of the comparison or `undefined` if any of the components are invalid.\n */\nexport function compareComponents(componentsA,componentsB) {\n    if (componentsA == null || componentsB == null) return undefined;\n\n    for (const componentId in ITEM_STATE_COMPONENTS) {\n        const componentDataA = componentsA[componentId];\n        const componentDataB = componentsB[componentId];\n        if (componentDataA != null && componentDataB != null) {\n            switch (componentId) {\n                case 'durability': {\n                    if (componentDataA.damage !== componentDataB.damage) return false;\n                }   break;\n                case 'enchantments': {\n                    for (const enchantId in componentDataA) {\n                        if (componentDataA[enchantId] != componentDataB[enchantId]) return false;\n                    }\n                    for (const enchantId in componentDataB) {\n                        if (componentDataB[enchantId] != componentDataA[enchantId]) return false;\n                    }\n                }   break;\n            }\n        } else if (\n            (componentDataA != null && componentDataB == null) ||\n            (componentDataA == null && componentDataB != null)\n        ) return false;\n    }\n    return true;\n}\n\n//## Getting state data:\n/**\n * Function to create `ItemStack` class from an `ItemState` that defines it.\n * @param {ItemState} itemState Item state defining what item to create.\n * @returns {Mc.ItemStack} Item stack created from the item state.\n */\nexport function createStack(itemState) {\n    if (itemState?.typeId == null) return null;\n    const itemStack = new Mc.ItemStack(itemState.typeId,itemState.amount);\n    itemStack.nameTag = itemState.nameTag;\n    itemStack.setLore(itemState.lore);\n    itemStack.keepOnDeath = itemState.keepOnDeath;\n    itemStack.lockMode = itemState.lockMode;\n    applyComponents(itemStack,itemState.components);\n    return itemStack;\n}\n/**\n * \n * @param {Mc.ItemStack} itemStack \n * @param {ItemComponentState} itemComponents \n */\nexport function applyComponents(itemStack,itemComponents) {\n    for (let componentId in itemComponents) {\n        const componentData = itemComponents[componentId];\n        const component = itemStack.getComponent(componentId);\n        if (component == null) continue;\n        switch (componentId) {\n            case 'durability': {\n                component.damage = componentData.damage;\n            }   break;\n            case 'enchantments': {\n                const enchantList = component.enchantments;\n                for (const enchantId in componentData) {\n                    enchantList.addEnchantment(\n                        new Mc.Enchantment(\n                            Mc.MinecraftEnchantmentTypes[enchantId],\n                            componentData[enchantId]\n                        )\n                    );\n                }\n            }   break;\n        }\n    }\n}\n\n\n//## Getting state data:\n/**\n * Function to copy `ItemStack` class objects with data that define its state.\n * @param {Mc.ItemStack} item Item to copy.\n * @returns {ItemState} Object containing copies of selected properties of the item.\n */\nexport function copyState(item) {\n    if (item?.typeId == null) return null;\n    return {\n        typeId: item.typeId,\n        nameTag: item.nameTag,\n        amount: item.amount,\n        lore: item?.getLore(),\n        keepOnDeath: item.keepOnDeath,\n        lockMode: item.lockMode,\n        components: copyComponents(item)\n    };\n}\n/**\n * Function to copy all components of an item.\n * @param {Mc.ItemStack} item Item to copy.\n * @returns {ItemComponentState} Object containing copies of components of the item. `undefined` if the item is invalid.\n */\nexport function copyComponents(item) {\n    if (item == null) return undefined;\n    const itemComponents = {};\n\n    /** @type {Mc.ItemDurabilityComponent} */\n    const durability = item.getComponent('durability');\n    if (durability != null) {\n        itemComponents.durability = {};\n        itemComponents.durability.damage = durability.damage;\n    }\n\n    /** @type {Mc.ItemEnchantsComponent} */\n    const enchants = item.getComponent('enchantments');\n    if (enchants != null) {\n        itemComponents.enchantments = {};\n        for (const enchant of enchants.enchantments) itemComponents.enchantments[enchant.type.id] = enchant.level;\n    }\n\n    return itemComponents;\n}\n\n//# Types / Constants:\n\n/**\n * @typedef ItemState\n * @prop {string} typeId ID of the type of the item.\n * @prop {state} nameTag The name of the item.\n * @prop {number} amount Number of items in the stack.\n * @prop {string[]} lore Lore strings of the item.\n * @prop {boolean} keepOnDeath Defines if the item is kept in player's inventory after death.\n * @prop {Mc.ItemLockMode} lockMode Defines if and how the item is locked in player's inventory.\n * @prop {ItemComponentState} components State of the item components.\n */\n\n/**\n * @typedef ItemComponentState Contains data of item components saved in a simple object.\n * @prop {object} durability Defines durability of the item.\n * @prop {number} durability.damage Defines how damaged the item is.\n * @prop {Object.<string,number>} enchantments Object of numerical value with keys defining the specific enchanment type and the number its level.\n */"]}